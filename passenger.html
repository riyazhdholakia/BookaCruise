<!DOCTYPE html>
<html lang = "en">
<head>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
        <link rel='icon' href='favicon.ico' type='image/x-icon'/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
<title>Passenger</title>
<!---<link rel="stylesheet" type="text/css" href="aboutme-style.css">-->
<style>
  body,
html {
    width: 100%;
    height: 100%;
    font-family: "Lato";
    color: white;
    background-image: url(pics/ocean1.jpg);
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center; 
}

h1 {
  padding-top: 5%;
	font-weight: 700;
	font-size: 5em;
}

.content{
	text-align: center;
    text-shadow: 0px 4px 3px rgba(0,0,0,0.4),
                 0px 8px 13px rgba(0,0,0,0.1),
                 0px 18px 23px rgba(0,0,0,0.1);
}
</style>
</head>
<body>
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">Cruising</a>
      </div>
      <div id="navbar" class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a href="index.html">Home</a></li>
          <li><a href="destination_departure.html">Book Now</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li><a href="login.html" onclick="return logout();">Log Out    <i class="fa fa-user"></i></a></li>
        </ul>
      </div>
    </div>
   </nav>

   <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="content">
          <h1>Passenger Info</h1>
        </div>
      </div>
    </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="content">
            <h3>Passenger 1</h3>
          </div>
        </div>
      </div>
      </div>
    
    <div class="container">
    <form class="needs-validation" onsubmit="return false,SavePassengerData()">
      <div class="form-row">
        <div class="col-md-4 mb-3">
          <label for="validationTooltip01">First Name</label>
          <input type="text" class="form-control" id="P1FirstName" placeholder="John" required>
          <div class="valid-tooltip">

          </div>
        </div>
        <div class="col-md-4 mb-3">
          <label for="validationTooltip02">Last Name</label>
          <input type="text" class="form-control" id="P1LastName" placeholder="Smith" required>
          <div class="valid-tooltip">

          </div>
        </div>
        <div class="col-md-4 mb-3">
          <label for="validationTooltip01">DOB</label>
          <input type="text" class="form-control" id="P1DOB" placeholder="01/05/1978" required>
          <div class="valid-tooltip">

          </div>
        </div>
      </div>
      <div class="form-row">
        <div class="col-md-6 mb-3">
          <label for="validationTooltip03">City</label>
          <input type="text" class="form-control" id="P1City" placeholder="Atlanta" required>
          <div class="invalid-tooltip">

          </div>
        </div>
        <div class="col-md-3 mb-3">
          <label for="validationTooltip04">State</label>
          <input type="text" class="form-control" id="P1State" placeholder="GA" required>
          <div class="invalid-tooltip">

          </div>
        </div>
        <div class="col-md-3 mb-3">
          <label for="validationTooltip05">Zip Code</label>
          <input type="text" class="form-control" id="P1Zip" placeholder="30020" required>
          <div class="invalid-tooltip">

          </div>
        </div>
      </div>
      <div class="form-row">
        <div class="col-md-6 mb-3">
          <label for="validationTooltip04">Email</label>
          <input type="email" class="form-control" id="P1Email" placeholder="hello@gmail.com" required>
          <div class="invalid-tooltip">
  
          </div>
        </div>
        <div class="col-md-6 mb-3">
          <label for="validationTooltip05">Phone Number</label>
          <input type="text" class="form-control" id="P1PhoneNumber" placeholder="404-111-8888" required>
          <div class="invalid-tooltip">
          </div>
        </div>
      </div>
    
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="content">
          <h3>Passenger 2</h3>
        </div>
      </div>
    </div>
    </div>

    <div class="form-row">
      <div class="col-md-4 mb-3">
        <label for="validationTooltip01">First Name</label>
        <input type="text" class="form-control" id="P2FirstName" placeholder="John">
        <div class="valid-tooltip">

        </div>
      </div>
      <div class="col-md-4 mb-3">
        <label for="validationTooltip02">Last Name</label>
        <input type="text" class="form-control" id="P2LastName" placeholder="Smith">
        <div class="valid-tooltip">

        </div>
      </div>
      <div class="col-md-4 mb-3">
        <label for="validationTooltip01">DOB</label>
        <input type="text" class="form-control" id="P2DOB" placeholder="01/05/1978">
        <div class="valid-tooltip">

        </div>
      </div>
    </div>
    <div class="form-row">
      <div class="col-md-6 mb-3">
        <label for="validationTooltip03">City</label>
        <input type="text" class="form-control" id="P2City" placeholder="Atlanta">
        <div class="invalid-tooltip">

        </div>
      </div>
      <div class="col-md-3 mb-3">
        <label for="validationTooltip04">State</label>
        <input type="text" class="form-control" id="P2State" placeholder="GA">
        <div class="invalid-tooltip">

        </div>
      </div>
      <div class="col-md-3 mb-3">
        <label for="validationTooltip05">Zip Code</label>
        <input type="text" class="form-control" id="P2Zip" placeholder="30020">
        <div class="invalid-tooltip">
          Zip Code
        </div>
      </div>
    </div>
    <div class="form-row">
      <div class="col-md-6 mb-3">
        <label for="validationTooltip04">Email</label>
        <input type="email" class="form-control" id="P2Email" placeholder="hello@gmail.com">
        <div class="invalid-tooltip">

        </div>
      </div>
      <div class="col-md-6 mb-3">
        <label for="validationTooltip05">Phone Number</label>
        <input type="text" class="form-control" id="P2PhoneNumber" placeholder="404-111-8888">
        <div class="invalid-tooltip">

        </div>
      </div>
    </div>
    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
    <center><button class="btn btn-success" type="submit";>Submit</button></center>
  </form>
</div>


              <script src="https://www.gstatic.com/firebasejs/5.8.3/firebase.js"></script>
  <script>
    var User;
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyAmbS9EKpnJRTE5AAnKKgUFMkdDF7KOePk",
      authDomain: "cruising-23cb7.firebaseapp.com",
      databaseURL: "https://cruising-23cb7.firebaseio.com",
      projectId: "cruising-23cb7",
      storageBucket: "",
      messagingSenderId: "322449955301"
    };
    firebase.initializeApp(config);
    firebase.auth().onAuthStateChanged(function(user) {
  if (user) {
    User=user;
    // User is signed in.
    var displayName = user.displayName;
    var email = user.email;
    var emailVerified = user.emailVerified;
    var photoURL = user.photoURL;
    var isAnonymous = user.isAnonymous;
    var uid = user.uid;
    var providerData = user.providerData;
    //window.open('index.html', '_self');
    // ...
  } else {
    location.href='login.html';
    // User is signed out.
    // ...
  }});
  </script>

  <script>
      function logout() {
        firebase.auth().signOut()
      }
        function goToPaymentPage() {
          window.open('payment.html', '_self');
     }
     function getSearchParameters() {
      var prmstr = window.location.search.substr(1);
      return prmstr != null && prmstr != "" ? transformToAssocArray(prmstr) : {};

    }
var params = [];
function transformToAssocArray( prmstr ) {
   
    var prmarr = prmstr.split("&");
    for ( var i = 0; i < prmarr.length; i++) {
        params.push(prmarr[i]);
    }
    return params;
}

function SavePassengerData(){

  P1Data={
    firstName: $('#P1FirstName').val(),

    lastName: $('#P1LastName').val(), 
    
    DOB: $('#P1DOB').val(), 
    
    city: $('#P1City').val(), 
    
    state: $('#P1State').val(), 
    
    Zip: $('#P1Zip').val(), 
    
    email: $('#P1Email').val(), 
    phoneNumber: $('#P1PhoneNumber').val(), 
    
  }
  P2Data={
    firstName: $('#P2FirstName').val(),

    lastName: $('#P2LastName').val(), 
    
    DOB: $('#P2DOB').val(), 
    
    city: $('#P2City').val(), 
    
    state: $('#P2State').val(), 
    
    Zip: $('#P2Zip').val(), 
    
    email: $('#P2Email').val(), 
    phoneNumber: $('#P2PhoneNumber').val(), 
    
  }
data={
  passengerOne:P1Data,
  passengerTwo:P2Data,
  destination: params[0],
  startDate:params[1],
  endDate:params[2],
  roomType:params[3],
  roomPrice:params[4],
  email: User.email
}
console.log(data);
var id=firebase.database().ref('Users/'+User.uid).push().getKey();
firebase.database().ref('Users/'+User.uid).update(data,function(){
  console.log('inserted');
  location.href='payment.html?'+User.uid;
})
  return false;
}
var params = getSearchParameters();
console.log(params);
    function getPassengerData(){
    }

// // Example starter JavaScript for disabling form submissions if there are invalid fields
// (function() {
//   'use strict';
//   window.addEventListener('load', function() {
//     // Fetch all the forms we want to apply custom Bootstrap validation styles to
//     var forms = document.getElementsByClassName('needs-validation');
//     // Loop over them and prevent submission
//     var validation = Array.prototype.filter.call(forms, function(form) {
//       form.addEventListener('submit', function(event) {
//         if (form.checkValidity() === false) {
//           event.preventDefault();
//           event.stopPropagation();
//         }
//         form.classList.add('was-validated');
//       }, false);
//     });
//   }, false);
// })();
  </script>
</body>
</html>
